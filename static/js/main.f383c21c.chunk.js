(this["webpackJsonpmaps-of-venice"]=this["webpackJsonpmaps-of-venice"]||[]).push([[0],{281:function(e,t){},463:function(e,t,a){e.exports=a(720)},468:function(e,t,a){},477:function(e,t){},719:function(e,t,a){},720:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(121),i=a.n(o),l=(a(468),a(410)),c=a(772),u=a(45);function s(e){return{type:"UPDATE_SELECTED_MAP",data:e}}var p=a(407),m=(a(473),a(476).initializeApp({apiKey:"AIzaSyBDQwZv9AJ40kjtWTVfjLjyMn3dSJMuiQI",authDomain:"maps-of-venice.firebaseapp.com",databaseURL:"https://maps-of-venice.firebaseio.com",projectId:"maps-of-venice",storageBucket:"maps-of-venice.appspot.com",messagingSenderId:"1004145915620",appId:"1:1004145915620:web:bb706ab87a353cf8eb5ef1",measurementId:"G-CYE960RYD9"}).firestore());function f(){var e=Object(u.b)();return Object(n.useEffect)((function(){m.collection("maps").orderBy("year").get().then((function(t){var a=t.docs.map((function(e){return e.data()}));e(function(e){return{type:"UPDATE_MAPS",data:e}}(a))})),m.collection("population").orderBy("year").get().then((function(t){var a=t.docs.map((function(e){return e.data()}));e(function(e){return{type:"UPDATE_POPULATION",data:e}}(a))})),fetch("https://api.github.com/gists/aa98d983dc8392db28e710e1c888033f").then((function(e){return e.json()})).then((function(t){return e({type:"UPDATE_GEOJSON",data:JSON.parse(t.files["map.geojson"].content)})}))}),[e]),null}var d=a(775),b=a(781),y=a(774);var v={latitude:45.437545,longitude:12.333794,zoom:13,minZoom:10,pitch:0,bearing:0},g=a(764),E=a(762),h=Object(E.a)({title:{color:"#FFFFFF",fontFamily:"Avenir",fontSize:12},body:{color:"#FFFFFF",fontFamily:"Avenir",fontSize:10}});function O(){var e=Object(u.c)((function(e){return e})).hoveredObj,t=h();return r.a.createElement(r.a.Fragment,null,e.obj&&r.a.createElement("div",{style:{backgroundColor:"rgba(46, 46, 46, 0.8)",padding:8,position:"absolute",top:e.y,left:e.x}},r.a.createElement(g.a,{classes:{root:t.title}},e.obj.properties.name," (",e.obj.properties.year,")")))}function j(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e})),a=t.maps,n=t.selectedMap,o=t.opacity,i=t.visible,l=t.geojson,s=function(t){var a=t.x,r=t.y,o=t.object;(!o||o.properties.year<=n)&&e({type:"UPDATE_HOVERED_OBJ",data:{x:a,y:r,obj:o}})};return r.a.createElement("div",null,r.a.createElement(c.a,{initialViewState:v,controller:{dragRotate:!1},layers:function(e){var t=e.data,a=e.currentYear,n=e.opacity,r=e.visible,o=e.geojson,i=e.onHover,l=[],c=function(){var e=t[u].tile,o=[0,1,2,3].map((function(t){return e.replace("https://maps.georeferencer.com/georeferences/","https://maps-".concat(t,".georeferencer.com//georeferences/"))}));l.push(new d.a({id:u,data:o,visible:r&&t[u].year===a,minZoom:0,maxZoom:19,tileSize:256,opacity:n,renderSubLayers:function(e){var t=e.tile.bbox,a=t.west,r=t.south,o=t.east,i=t.north;return new b.a(e,{data:null,image:e.data,bounds:[a,r,o,i],opacity:n})}}))};for(var u in t)c();return Object.keys(o).length>0&&l.push(new y.a({id:"geojson",data:o,pickable:!0,getFillColor:function(e){return e.properties.year<=a?[255,255,0,50]:[0,0,0,0]},getLineColor:[255,255,0,100],getLineWidth:function(e){return e.properties.year<=a?2:0},lineWidthUnits:"pixels",onHover:i,updateTriggers:{getLineWidth:a,getFillColor:a}})),l}({data:a,currentYear:n,opacity:o,visible:i,geojson:l,onHover:s})},r.a.createElement(p.a,{mapboxApiAccessToken:"pk.eyJ1IjoieXpoZW5nMTk5OCIsImEiOiJjazhqM2d2c3EwMzdlM2dwanc0Nnc1bW5wIn0.zee4RAVq4YvHdnWIKGSZ-w"}),r.a.createElement(O,null)),r.a.createElement(f,null))}var F=a(293),x=a(780),T=a(71),A=a(391),S=Object(E.a)({subtitle:{color:"#FFFFFF",fontFamily:"Avenir",fontSize:14},title:{color:"#FFFFFF",fontFamily:"Avenir",fontSize:14,fontWeight:"Bold"}});function L(e){var t=S(),a=e.xFormatted,n=e.yFormatted;return r.a.createElement("div",{style:{backgroundColor:"rgba(46, 46, 46, 0.8)",padding:8}},r.a.createElement(g.a,{classes:{root:t.title}},a),r.a.createElement(g.a,{classes:{root:t.subtitle}},"Population: ",n))}function _(e){var t=[{id:"Population",data:Object(u.c)((function(e){return e})).population.map((function(e){return{x:e.year,y:e.population}}))}];return r.a.createElement("div",{style:{height:150,marginBottom:-13}},r.a.createElement(I,{data:t}))}var I=function(e){var t=e.data;return r.a.createElement(A.a,{data:t,margin:{top:0,bottom:0,right:0,left:0},xScale:{type:"linear",min:1603,max:1920},xFormat:".0f",yScale:{type:"linear",min:9e4,max:"auto",stacked:!0,reverse:!1},tooltip:function(e){var t=e.point.data;return r.a.createElement(L,t)},yFormat:".3s",axisTop:null,enableArea:!0,areaBaselineValue:9e4,areaOpacity:.2,lineWidth:3,axisRight:null,axisBottom:null,axisLeft:null,colors:"#17bdff",useMesh:!0,crosshairType:"bottom",enablePoints:!0,pointSize:5,pointBorderWidth:2,pointColor:"#FFFFFF",pointBorderColor:"#17bdff",enableGridX:!1,enableGridY:!1})},w=a(778),k=a(406),P=a.n(k),D=a(405),G=a.n(D),C=Object(T.a)({root:{color:"#ffffff",backgroundColor:"#17bdff",borderRadius:5,width:47,height:35,"&:hover":{backgroundColor:"#3dc7ff"}}})(w.a);function M(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e})),a=t.maps,o=t.selectedMap,i=t.playing,l=a.map((function(e){return e.year}));return Object(n.useEffect)((function(){var t=l.findIndex((function(e){return e===o}));if(i){var a=setTimeout((function(){return e(s(l[(t+1)%l.length]))}),500);return function(){return clearTimeout(a)}}}),[i,o,e,l]),r.a.createElement(C,{onClick:function(){e({type:"TOGGLE_PLAYING"})}},i?r.a.createElement(G.a,null):r.a.createElement(P.a,null))}var B=a(72),R=Object(T.a)({root:{fontSize:16,fontFamily:"Avenir",fontWeight:"bold"}})(g.a);function U(e){var t=e.text,a=e.style;return r.a.createElement("div",{style:Object(B.a)({},a)},r.a.createElement(R,null,t))}var V=Object(T.a)({root:{color:"#17bdff",height:4},track:{height:3},rail:{height:3},markLabel:{fontSize:14,fontFamily:"Avenir",fontWeight:"bold"},mark:{width:2,height:7,marginTop:-2}})(x.a);function N(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e})),a=t.maps,n=t.selectedMap,o=a.map((function(e){return e.year})),i=Math.min.apply(Math,Object(F.a)(o)),l=Math.max.apply(Math,Object(F.a)(o)),c=a.map((function(e,t){return{value:e.year,label:t!==a.length-3&&(0===t||t===a.length-1||a[t-1].year<e.year-7)?e.year:""}}));return r.a.createElement("div",{style:{position:"absolute",bottom:40,marginLeft:"auto",marginRight:"auto",left:0,right:0,display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"center",width:"100%"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginRight:12,marginBottom:34}},r.a.createElement(U,{text:"Population:",style:{marginBottom:47,fontWeight:"bold"}}),r.a.createElement(M,null)),r.a.createElement("div",{style:{display:"flex",alignSelf:"center",flexDirection:"column",width:"80%",marginRight:"5%"}},r.a.createElement(_,null),r.a.createElement(V,{value:n,onChange:function(t,a){return e(s(a))},valueLabelFormat:function(e){return e},valueLabelDisplay:"auto",min:i,max:l,step:null,marks:c,track:"normal"})))}var z=Object(T.a)({root:{color:"#17bdff",height:4}})(x.a);function W(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e})).opacity;return r.a.createElement("div",{style:{position:"absolute",top:40,right:40,display:"flex",width:100,height:30}},r.a.createElement(z,{value:Math.round(100*t),onChange:function(t,a){return e({type:"UPDATE_OPACITY",data:a/100})},getAriaValueText:function(e){return e},valueLabelFormat:function(e){return e},"aria-labelledby":"slider",valueLabelDisplay:"auto",min:0,max:100,marks:!0,track:"inverted"}))}var Y=Object(T.a)({root:{fontSize:16,fontFamily:"Avenir"}})(g.a),J=Object(T.a)({root:{fontSize:20,fontFamily:"Avenir",fontWeight:"bold"}})(g.a);function H(){var e=Object(u.c)((function(e){return e})),t=e.maps,a=e.selectedMap,n=t.find((function(e){return e.year===a}));return r.a.createElement(r.a.Fragment,null,n&&r.a.createElement("div",{onClick:function(){return window.open(n.source,"_blank")},style:{position:"absolute",top:30,marginLeft:"auto",marginRight:"auto",left:0,right:0,width:"50%",backgroundColor:"rgb(255, 255, 255, .7)",border:".5px solid grey",borderRadius:"5px",padding:"2px",cursor:"pointer"}},r.a.createElement(J,null,n&&"".concat(n.creator," (").concat(n.origin&&"".concat(n.origin," ")).concat(n.year,")")),r.a.createElement(Y,null,n&&n.title)))}var X=Object(T.a)({root:{fontSize:14,fontFamily:"Avenir"}})(g.a);function Z(e){var t=e.visible,a=e.text,n=e.style;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{style:Object(B.a)({backgroundColor:"rgb(255, 255, 255, .7)",border:".5px solid grey",borderRadius:"5px",padding:"2px",margin:"5px 0px"},n)},r.a.createElement(X,null,a)))}function K(){var e=Object(u.b)(),t=Object(u.c)((function(e){return e})),a=t.visible,o=t.controlsVisible,i=t.playing,c=Object(n.useState)(!0),s=Object(l.a)(c,2),p=s[0],m=s[1];return r.a.createElement("div",{onKeyDown:function(t){"Shift"===t.nativeEvent.key&&a&&(e({type:"TOGGLE_VISIBLE"}),m(!1)),"Alt"===t.nativeEvent.key&&o&&(e({type:"TOGGLE_CONTROLS_VISIBLE"}),i&&e({type:"TOGGLE_PLAYING"}))},onKeyUp:function(t){"Shift"===t.nativeEvent.key&&!a&&e({type:"TOGGLE_VISIBLE"}),"Alt"===t.nativeEvent.key&&!o&&e({type:"TOGGLE_CONTROLS_VISIBLE"})},onKeyPress:function(t){" "===t.key&&e({type:"TOGGLE_PLAYING"})}},r.a.createElement(j,null),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(H,null),r.a.createElement("div",{style:{position:"absolute",top:25,left:40,width:"15%",display:"flex",flexDirection:"column"}},r.a.createElement(Z,{visible:p,text:"Hold shift to compare with base map"})),r.a.createElement(N,null),r.a.createElement(W,null)))}a(719);var q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(K,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Q=a(209),$={maps:[],population:[],selectedMap:1603,opacity:1,visible:!0,controlsVisible:!0,geojson:{},hoveredObj:{},playing:!1};var ee=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),te=Object(Q.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_MAPS":return Object(B.a)({},e,{maps:t.data});case"UPDATE_POPULATION":return Object(B.a)({},e,{population:t.data});case"UPDATE_SELECTED_MAP":return Object(B.a)({},e,{selectedMap:t.data});case"UPDATE_OPACITY":return Object(B.a)({},e,{opacity:t.data});case"TOGGLE_VISIBLE":return Object(B.a)({},e,{visible:!e.visible});case"UPDATE_GEOJSON":return Object(B.a)({},e,{geojson:t.data});case"UPDATE_HOVERED_OBJ":return Object(B.a)({},e,{hoveredObj:t.data});case"TOGGLE_PLAYING":return Object(B.a)({},e,{playing:!e.playing});case"TOGGLE_CONTROLS_VISIBLE":return Object(B.a)({},e,{controlsVisible:!e.controlsVisible});default:return e}}),ee);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:te},r.a.createElement(q,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[463,1,2]]]);
//# sourceMappingURL=main.f383c21c.chunk.js.map